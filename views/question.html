<div class="container">
	<form class="form-horizontal mtop-navbar-row">
	    <div class="row">
	        <div class="col-md-9">
	        	<blockquote>
	    			<p>
	    				<a href data-toggle="modal" data-target="#myModal" ng-show="question.question_image_url" ng-click="open_image_model()">
	    					<img class="img-thumbnail pull-right" width="250px" ng-src="{{question.question_image_url}}">
	    				</a>

	    				<script type="text/ng-template" id="imageModalContent.html">
						    <div class="modal-header">
						        <h4 class="modal-title" id="myModalLabel"><i class="fa fa-search"></i> Vergößerung</h4>
						    </div>
						    <div class="modal-body">
						        <center><img class="img-thumbnail" ng-src="{{image_url}}"></center>
						    </div>
						    <div class="modal-footer">
						        <button type="button" class="btn btn-success" ng-click="$close()">Schließen</button>
						    </div>
						</script>

	    				<span ng-bind-html="question.question | newline_to_br"></span>

	    				<span class="label label-info" ng-show="question.type==1"> Freie Frage</span>
	    				<span class="label label-warning" ng-show="question.type>1 && question.correct_answer==0"> Keine Antwort</span>
	    			</p>
	    		</blockquote>

	    		<div class="form-group showhim" ng-repeat="answer in question.answers track by $index" ng-show="question.type>1 && answer">
		    		<div class="col-sm-offset-1 col-sm-10">
		    		    <div class="btn-group pull-left hidden-xs" style="margin-left: -50px; margin-top:6px;">
			    			<button class="btn btn-default btn-xs showme" ng-model="strike[$index+1]" btn-checkbox><i class="fa fa-fw fa-strikethrough"></i></button>
			    		</div>
	    		    	<div class="radio" ng-click="save_answer($index+1)">
	    		        	<label>
	    		        		<input type="radio" name="answers" ng-checked="checked_answer==$index+1" ng-value="$index+1"/>
	    		        		<p class="question-answer {{correctAnswer==$index+1 ? 'text-success strong bg-success':''}} {{wrongAnswer==$index+1 ? 'text-danger strong bg-danger':''}} {{strike[$index+1]==1 && correctAnswer!=$index+1? 'text-danger strike':''}}" ng-bind-html="answer"></p>
	    		        	</label>
	    		    	</div>
	    		    </div>
	    		</div>

	    		<div class="form-group" ng-show="question.type==1">
	    		    <div class="col-sm-offset-1 col-sm-10">
	    		    	<div class="radio">
	    		        	<label>
	    				    	<p ng-show="mark_answer_free" ng-bind-html="question.answers[0]"></p>
	    				    </label>
	    		    	</div>
	    		    </div>
	    		</div>
	        </div>

	        <div class="col-md-3 hidden-sm hidden-xs">
	        	<div class="panel panel-default" ng-show="question.exam_id">
	        		<div class="panel-heading"><h3 class="panel-title"><i class="fa fa-fw fa-flask"></i> {{ question.subject }}</h3></div>
	        		<ul class="list-group">
	        			<li class="list-group-item">{{ question.semester }}. Semester<span ng-show="question.sort">, {{ question.sort }}</span></li>
	        			<li class="list-group-item"><i class="fa fa-fw fa-calendar"></i> {{ question.date }}</li>
	        			<li class="list-group-item" ng-if="question.professor"><i class="fa fa-fw fa-user-md"></i> {{ question.professor }}</li>
	        			<li class="list-group-item" ng-if="question.topic != 'Sonstiges' && question.topic != ''">
	        				<i class="fa fa-fw fa-angle-right"></i> {{ question.topic }}
	        			</li>

	        			<li class="list-group-item" ng-if="questionList.list">
							<p class="strong">Frage {{ index + 1 }} von {{ length }}</p>

							<progress><bar value="(index+1) / length * 100" type="success"></bar></progress>

							<div class="exam-progress-comment text-success" ng-show="(1 > Math.abs(current_index+1 - question.question_count/2)) && (current_index > 3)">
								Halbzeit!
							</div>

							<p ng-show="question.topic != '' && question.topic != 'Sonstiges'">
								<i class="fa fa-fw fa-angle-right"></i> {{ question.topic }}
							</p>
						</li>
	        		</ul>
	    		</div>

	        	<hr>
	        	
	        	<tags-input placeholder="Markierung hinzufügen" ng-model="question.tags" on-tag-added="updateTags($tag)" on-tag-removed="updateTags($tag)"></tags-input>
	        </div>
	    </div>

	    <hr>

	    <div class="btn-toolbar mmtop">
	    	<div class="btn-group">
	    		<a class="btn btn-default mtop" ng-if="questionList.list" ng-disabled="index==0" href="question?id={{ questionList.list[index-1]['question_id'] }}">
		    		<i class="fa fa-backward"></i>
		    	</a>

	    		<button class="btn mtop" ng-class="answerButtonClass" ng-disabled="answerButtonClass!='btn-primary' || (question.type==1 && question.answers[0].length==0) || (question.type>1 && question.correct_answer==0)" ng-click="show_solution()">
					Lösung anzeigen
	    		</button>

	    		<button class="btn btn-default mtop" ng-disabled="!question.explanation" ng-click="show_explanation=1-show_explanation" data-toggle="button">
	    			Erklärung
	    		</button>

	    		<a class="btn btn-default mtop" ng-if="questionList.list" ng-disabled="index==length-1" href="question?id={{ questionList.list[index+1]['question_id'] }}">
		    		<i class="fa fa-forward"></i>
		    	</a>
	    	</div>

	    	<a class="btn btn-danger mtop" ng-if="questionList.list" href="analysis">Klausur beenden</a>

	    	<a ng-if="user.group_id == 2 || user.group_id == 3" class="btn btn-default pull-right mtop hidden-xs" href="edit-exam?id={{ question.exam_id }}&question_id={{ question_id }}">
		    	Bearbeiten
		    </a>

	    	<div class="btn-group pull-right mtop">
				<a class="btn btn-default dropdown-toggle" data-toggle="dropdown">Melden <span class="caret"></span></a>

	        	<ul class="dropdown-menu">
	        		<li><a href="/contact?question_id={{ question_id }}" tabindex="-1" target="_self">
	        			Allgemein
	        		</a></li>
	        		<li><a href="/contact?question_id={{ question_id }}&s=Rechtschreibfehler" tabindex="-1" target="_self">
	        			Rechtschreibfehler
	        		</a></li>
	        		<li><a href="/contact?question_id={{ question_id }}&s=Antwort" tabindex="-1" target="_self">
	        			{{ question.correct_answer >= 0 ? 'Falsche Antwort' : 'Antwort geben' }}
	        		</a></li>
	        		<li class="divider"></li>
	        		<li><a href="/contact?question_id={{ question_id }}" tabindex="-1" target="_self">
	        			Erklärung schreiben
	        		</a></li>
	        	</ul>
	        </div>

	        <div class="btn-group pull-right mtop hidden-xs" role="group">
				<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
					<i class="fa fa-fw fa-file-pdf-o"></i> PDF
					<span class="caret"></span>
				</button>

				<ul class="dropdown-menu" role="menu">
					<li ng-class="{disabled: question.file_name == ''}">
						<a href="/public/files/{{question.file_name}}" target="_self" ng-if="question.file_name != ''">Originaldokument</a>
						<a ng-if="question.file_name == ''">Originaldokument</a>
					</li>

					<li><a href="exam-pdf?id={{ question.exam_id }}" target="_self">Klausur als PDF</a></li>
					<li><a href="exam-solution-pdf?id={{ question.exam_id }}" target="_self">Lösungen als PDF</a></li>
				</ul>
			</div>
	    </div>
	</form>

	<div class="panel panel-default mtop-2x" ng-show="show_explanation"><div class="panel-body"><span ng-bind-html="question.explanation"></span></div></div>

	<hr>

	<div class="panel panel-default mbottom-2x">
	    <div class="panel-heading">
	    	<h4 class="panel-title">
	    		<a data-toggle="collapse" data-parent="#accordion" data-target="#collapseOne">
					<i class="fa fa-comments fa-fw"></i>Kommentare
					<div class="pull-right"><span class="badge">{{ question.comments.length }}</span></div>
	    		</a>
	    	</h4>
	    </div>

	    <div class="panel panel-collapse collapse {{ user.showComments==0 ? 'in':'' }}" id="collapseOne">
	        <div class="panel-body">
	        	<form method="post">
	        		<input type="hidden" name="question_id" ng-value="question_id">
	        		<div class="form-group">
	    				<label for="disabledTextInput">{{ user.username }}</label>
	        			<div class="row">
	        			    <div class="col-lg-10 col-md-9 col-sm-8">
	        			    	<textarea class="form-control" name="commentText" rows="3" ng-model="commentText"></textarea>
	        			    </div>
	        			    <div class="col-lg-2 col-md-3 col-sm-4">
	        			    	<!--div class="checkbox">
	        				    	<label><input id="subscriptCommentsCheckbox" type="checkbox" <?php if($subscription['subscription']){ echo 'checked="true"'; } ?>> Antworten per Mail</label>
	        				    </div-->
	        				    <br>
	        				    <button class="btn btn-primary btn-block" ng-click="add_comment()" ng-disabled="!commentText">Kommentieren</button>
	        			    </div>
	        			</div>
	        		</div>
	        	</form>
	        </div>

	        <ul class="list-group">
	        	<div id="comments">
	        		<li class="list-group-item" id="comment" ng-repeat="comment in question.comments">
	        			<div class="row">
	        				<div class="col-md-3 col-sm-3 col-xs-4">
		        				<div class="comment-voting pull-left">
			        				<div><a ng-click="comment.user_voting = increase_user_voting(comment.user_voting, comment.comment_id)" href>
				        				<i class="fa fa-chevron-up text-muted" ng-class="comment.user_voting == '1' ? 'text-success':''"></i>
				        			</a></div>

			        				<div class="comment-voting-number"><small class="text-muted">{{ comment.voting + comment.user_voting }}</small></div>

			        				<div class="comment-voting-down">
				        				<a ng-click="comment.user_voting = decrease_user_voting(comment.user_voting, comment.comment_id)" href>
				        					<i class="fa fa-chevron-down text-muted" ng-class="comment.user_voting == '-1' ? 'text-danger':''"></i>
				        				</a>
				        			</div>
		        				</div>

							    <div class="header">
							    	<strong class="primary-font">{{ comment.username }}</strong>
							    	<br>
							        <small class="text-muted">
							        	<i class="fa fa-clock-o"></i>
							        	<span timeago="{{comment.date * 1000}}">
							        </small>
								</div>
							</div>
							<div class="col-md-6 col-sm-5 col-xs-4">
							    <p>{{ comment.comment }}</p>
							</div>
							<div class="col-md-3 col-sm-4 col-xs-4">
							    <div class="btn-group pull-right">
							    	<button type="button" class="close" ng-click="delete_comment($index)">&times;</button>
							    </div>
							</div>
	        			</div>
	        		</li>
	        	</div>
	        </ul>
	    </div>
	</div>
</div>